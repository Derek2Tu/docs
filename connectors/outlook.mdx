---
title: 'Outlook'
description: 'The Carbon Connect `enabledIntegrations` value for Outlook is `OUTLOOK`.'
---

## Authorization Type

Carbon uses **[OAuth 2.0](https://learn.microsoft.com/en-us/onedrive/developer/rest-api/getting-started/msa-oauth?view=odsp-graph-online)** to connect to Outlook.

## Authorization Flow

Log into your Microsoft account.
![](https://i.ibb.co/86FPknL/Screen-Shot-2023-08-31-at-4-41-48-PM.png)

### Custom OAuth Credentials

#### Setting up the OAuth App

1. Create or log into your [Microsoft Azure](https://portal.azure.com/) Account.

2. Under `Azure Services`, select `App Registration` -> `New registration`.

![](https://i.ibb.co/SPR4ztF/Screen-Shot-2023-09-08-at-2-52-56-PM.png)

3. Select `Accounts in any organizational directory (Any Microsoft Entra ID tenant - Multitenant) and personal Microsoft accounts (e.g. Skype, Xbox)` as the `Supported account types`.

![](https://i.ibb.co/qBLpg1r/Screen-Shot-2023-09-12-at-11-09-28-PM.png)

4. Add https://api.carbon.ai/integrations/outlook as the `Redirect URI` and select `Web` under the `Select a platform` dropdown. You can also opt to use a custom CNAME record pointing to https://api.carbon.ai. The domain path must still be `/integrations/outlook`.

![](https://i.ibb.co/9NTZycz/Screen-Shot-2023-09-08-at-2-59-16-PM.png)

5. Under `Manage` -> `API permissions` add the permissions `Files.Read.All`, `offline_access`, `openid`, and `User.Read`.

![](https://i.ibb.co/VTGK90Z/Onedrive-1.png)

6. Under `Client credentials`, click `Add a certificate or secret` -> `New Client Secret`. Then copy the client secret’s `Value` and share it with us via Slack.

![](https://i.ibb.co/0tghs0p/Screen-Shot-2023-09-08-at-3-13-30-PM.png)

7. Navigate to the `Overview` tab then copy the `Application (client) ID` and share it with us via Slack.

![](https://i.ibb.co/KGWzr1H/Screen-Shot-2023-09-12-at-11-14-08-PM.png)

8. Customize your app branding under `Manage` -> `Branding & properties`.

![](https://i.ibb.co/HrS9Cxj/Screen-Shot-2023-09-08-at-3-24-16-PM.png)

## Synchronization

After successfully connecting your Outlook account, you gain the ability to selectively sync emails by utilizing the `filters` parameter via the `/integrations/Outlook/sync` endpoint. This parameter operates as a JSON object comprising key-value pairs, supporting both AND and OR operations. Presently, our system accommodates a specific set of keys as detailed below:

#### `label`
Represents predefined Outlook labels such as "Important" or custom labels created by the user.

#### `after`
Accepts a date in the format YYYY/mm/dd (e.g., 2023/12/31), enabling the retrieval of emails after a specified date.

#### `before`
Accepts a date in the format YYYY/mm/dd (e.g., 2023/12/31), enabling the retrieval of emails before a specified date.

#### `is` 
Supports values like `starred`, `important`, `snoozed`, and `unread` to filter emails based on these attributes.

It's crucial to adhere to the specified keys and values within the JSON object. Usage of keys or values outside this defined scope might result in unexpected behavior.

An example of a basic query with filters, which lists all emails that have the label `Test`:

```
{
    "filters": {
            "key": "label",
            "value": "Test"
        }
}
```

You can use AND and OR operation as follows. 

This setup ensures the retrieval of emails dated after January 7th that satisfy either of the two conditions: having the label "Personal" or being marked as 'starred'. The structure allows for the effective use of AND and OR operations to filter emails based on the defined criteria.

<Note>This example demonstrates the highest level of nesting we support. You can't add more AND/OR filters within the OR filter in the example below.</Note>

```
{
    "filters": {
        "AND": [
            {
                "key": "after",
                "value": "2024/01/07"
            },
            {
                "OR": [
                    {
                        "key": "label",
                        "value": "Personal"
                    },
                    {
                        "key": "is",
                        "value": "starred"
                    }
                ]
            }
        ]
    }
}
```

You can use the `resync_file` API endpoint to programmatically resync specific Outlook emails. To delete specific emails from Carbon, you can use the `delete_files` endpoint directly.

We do not run our 24-hour batch sync for Outlook by default. If you’d like us to enable batch syncs to run in the background, you can request this via Slack.